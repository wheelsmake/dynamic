(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{register:()=>D});var n={};e.r(n),e.d(n,{getHash:()=>R,getSearch:()=>U});var o={};function r(e,t){return-1===t.indexOf(e)?null:t.splice(t.indexOf(e),1)[0]}function i(e,t,n,o){throw e===undefined?new Error("An error occured."):(console.error("ERROR INFO: argument",e,",type",t,",value",n,",reason",o),new Error(`Argument '${e}' ${t?`should be a(an) ${t}`:"is invalid"}${o?`, reason: ${o}`:""}${n?`, got ${n}`:""}.`))}function s(e){return Array.from(new Set(e))}function l(e,t){t!==undefined&&t instanceof Element||(t=document);let n=t.querySelectorAll(e);return n.length?1==n.length&&e.match(/^.*#[^\s]*$/)?n[0]:Array.from(n):[]}function a(e){""!==e&&"string"==typeof e||i("HTML","string",e);const t=document.createElement("div");return t.innerHTML=e,function(e){var t=[];for(let n=0;n<e.childNodes.length;n++)t[n]=e.childNodes[n].cloneNode(!0);return t}(t)}function c(e,t,n,o){null===t.parentElement&&function(e){throw new Error(e)}("cannot render by '<html>' element, since it's root of document.");var r=[];if("string"==typeof e)r=a(e);else if(e instanceof Element||e instanceof Node)r[0]=e.cloneNode(!0);else if(e instanceof HTMLCollection||e instanceof NodeList)for(let l=0;l<e.length;l++)r[l]=e.item(l).cloneNode(!0);else r=e;const i=[...r].reverse(),s=t.parentElement;if(!0===o)for(let l=0;l<r.length;l++)t.append(r[l]);else if(!1===o)for(let l=0;l<i.length;l++)t.prepend(i[l]);else if(!0===n)if(t.nextSibling)for(let l=0;l<i.length;l++)s.insertBefore(i[l],t.nextSibling);else for(let l=0;l<i.length;l++)s.append(i[l]);else if(!1===n)for(let l=0;l<r.length;l++)s.insertBefore(r[l],t);else for(let l=0;l<r.length;l++)t.append(r[l]);return r}e.r(o),e.d(o,{add:()=>B});const f=Function.prototype.toString;function u(e,t,n,o){const r=t.shouldExports;d(n);let i=!1;for(let s=0;s<r.length;s++)if(r[s][0]===n){i=!0;break}if(i)console.warn("Duplicated function",n,"is blocked being added to data",t);else{const i=[n,o,!1];r.push(i),n.call(e,i,t.value)}return[...r]}function d(e){f.call(e).match(/^\([^\(\)]*\)[\s]*=>/)&&i("func",undefined,e,"this function must not be an arrow function")}function h(e){return"symbol"==typeof e&&i(e.toString(),"string",e,"index of Dynamic.data must not be a Symbol"),e}const g=Object.prototype.toString;function p(e){if("object"!=typeof e&&i("input","object",e),null===e)return"null";{let t="{";const n=Object.keys(e),o=m(e);if(0==n.length)return"[object Object]"!=o?o:"{}";{const r=function(e){const t=new WeakMap;return function n(e,o){if("object"!=typeof e||null===e||e instanceof Boolean||e instanceof Date||e instanceof Number||e instanceof RegExp||e instanceof String)return e;{const r=t.get(e);if(r!==undefined&&-1!=o.indexOf(r))return{$ref:r};if(t.set(e,o),e instanceof Array){const t=[];for(let r=0;r<e.length;r++)t[r]=n(e[r],o+"["+r+"]");return t}{const t={},r=Object.keys(e);if(0!=r.length)for(let i=0;i<r.length;i++)t[r[i]]=n(e[r[i]],o+"["+JSON.stringify(r[i])+"]");else if("[object Object]"!=m(e))return e;return t}}}(e,"$")}(e);for(let s=0;s<n.length;s++){const l=n[s],a=r[l],c=typeof a;function f(e){t+=`${l}: ${e}`}"undefined"==c||"number"==c||"boolean"==c?f(a):"string"==c?f(`"${a}"`):"bigint"==c?f(a+"n"):"symbol"==c?f(a.toString()):"function"==c?f(m(a)):"object"==c&&f(p(a)),s<n.length-1&&(t+=", ")}return t+="}",t}}}function m(e){return"toString"in e?e.toString():g.call(e)}var b,y,w,v,E,$,x,A,N,k,M,O=undefined&&undefined.__classPrivateFieldSet||function(e,t,n,o,r){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?r.call(e,n):r?r.value=n:t.set(e,n),n},S=undefined&&undefined.__classPrivateFieldGet||function(e,t,n,o){if("a"===n&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?o:"a"===n?o.call(e):o?o.value:t.get(e)};const T={l:"_:",r:":_"},j={l:"_-",r:"-_"},_=":",L=new RegExp(`^${T.l}[a-zA-Z$_][\\w$]*${T.r}$`),C=new RegExp(`^${j.l}[a-zA-Z$_][\\w$]*${j.r}$`),P=new RegExp(`${T.l}[a-zA-Z$_][\\w$]*${T.r}`,"g"),W=new RegExp(`${j.l}[a-zA-Z$_][\\w$]*${j.r}`,"g"),H=["鬼片出现了！","Access to deleted property was blocked: ",", automatically treated as one-way binding.","function"];class I{constructor(e){b.add(this),y.set(this,void 0),w.set(this,new WeakMap),v.set(this,new WeakMap),E.set(this,new WeakMap),$.set(this,new MutationObserver((e=>{for(let t=0;t<e.length;t++){const n=e[t],o=n.type;"attributes"==o&&S(this,w,"f").has(n.target)?S(this,w,"f").get(n.target)(n):"characterData"==o&&S(this,v,"f").has(n.target)?S(this,v,"f").get(n.target)(n):"childList"==o&&S(this,E,"f").has(n.target)&&S(this,E,"f").get(n.target)(n)}}))),x.set(this,{}),A.set(this,new Proxy(S(this,x,"f"),{get(e,t,n){if((t=h(t))in e&&!e[t].deleted){let n;return n=typeof e[t].value==H[3]?e[t].cache:e[t].value,n}if(!(t in e))return undefined;e[t].deleted?console.warn(`${H[1]}${t}.`):console.error(H[0],"get",t)},set(e,t,n,o){if((t=h(t))in e&&!e[t].deleted){const i=e[t].value;if(i!==n){e[t].value=n,r(e[t]);const l=e[t].shouldExports;for(let c=0;c<l.length;c++)l[c][0].call(o,l[c],i);for(let f=0;f<e[t].shouldUpdates.length;f++)a(e[t].shouldUpdates[f]);function a(t){if(t in e&&typeof e[t].value==H[3]){const n=e[t].cache;e[t].cache=e[t].value.call(o);const r=e[t].shouldExports;for(let e=0;e<r.length;e++)r[e][0].call(o,r[e],n);for(let o=0;o<e[t].shouldUpdates.length;o++)a(e[t].shouldUpdates[o])}}}}else t in e?e[t].deleted?console.warn(`${H[1]}${t}.`):console.error(H[0],"set",t):(e[t]=function(e,t,n){const o={value:e,deleted:!1,shouldUpdates:t||[],shouldExports:n||[]};return"function"==typeof o.value&&(o.cache=undefined),o}(n),r(e[t]));return!0;function r(r){if(t=h(t),typeof n==H[3]){d(n),r.cache=n.call(o);const i=function(e){const t={double:!1,single:!1,reversed:!1},n=[];var o=0;for(let r=0;r<e.length;r++)"\\n"==e[r]&&(t.double=!1,t.single=!1),"`"!=e[r]||t.single||t.double||(t.reversed=!t.reversed),'"'!=e[r]||t.single||t.reversed||(t.double=!t.double),"'"!=e[r]||t.double||t.reversed||(t.single=!t.single),t.reversed&&"$"==e[r]&&e[r+1],e[r].match(/[\w$]/)||0==o||t.single||t.double||t.reversed||(n.push(e.substring(o,r)),o=0),t.single||t.double||t.reversed||"t"!=e[r]||"h"!=e[r+1]||"i"!=e[r+2]||"s"!=e[r+3]||"."!=e[r+4]||(o=r+5,r+=4);return s(n)}(Function.prototype.toString.call(n));for(let n=0;n<i.length;n++)i[n]in e||(o[i[n]]=undefined),-1==e[i[n]].shouldUpdates.indexOf(t)&&e[i[n]].shouldUpdates.push(t)}else delete r.cache}},deleteProperty:(e,t)=>{const n=(t=h(t))in e;return n&&(S(this,A,"f")[t]=undefined,e[t].deleted=!0),n}})),N.set(this,{}),k.set(this,new Proxy(S(this,N,"f"),{get:(e,t,n)=>(t=h(t))in e?e[t].bind(S(this,A,"f")):undefined})),O(this,y,function(e){if(e instanceof Element)return e;if("string"==typeof e){const t=l(e);if(t instanceof Node)return t;i("rootNode","string | Element",e,"rootNode should be a VALID #id selector")}else i("rootNode","string | Element",e,"rootNode should be a #id selector or an Element")}(e),"f"),S(this,b,"m",M).call(this,S(this,y,"f")),S(this,$,"f").observe(S(this,y,"f"),{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0})}get rootNode(){return S(this,y,"f")}get dOProcessorStore(){return S(this,v,"f")}get data(){return S(this,A,"f")}get _(){return S(this,A,"f")}addExport(e,t,n){return u(S(this,A,"f"),S(this,x,"f")[e],t,n)}removeExport(e,t){return function(e,t){const n=e.shouldExports;if("string"==typeof t)if(""==t)console.warn("Operation blocked trying to remove ALL annoymous functions. Use the function itself for argument instead.");else for(let o=0;o<n.length;o++)n[o][0].name===t&&r(n[o],n);else if("function"==typeof t)for(let o=0;o<n.length;o++)n[o][0]===t?r(n[o],n):i("func","string | exportFunc",t);return[...n]}(S(this,x,"f")[e],t)}getExports(e){return[...S(this,x,"f")[e].shouldExports]}get methods(){return S(this,k,"f")}get $(){return S(this,k,"f")}hydrate(e){e=function(e){if(e instanceof Node)return e;if("string"==typeof e){const t=l(e);if(t instanceof Node)return t;i("rootNode","string | Element",e,"rootNode should be a VALID #id selector")}else i("rootNode","string | Element",e,"rootNode should be a #id selector or an Element")}(e),S(this,y,"f").contains(e)?S(this,b,"m",M).call(this,e):i("node",undefined,e,"the input node must be a descendant of the rootNode")}}function D(){}function U(){var e=location.search;if(""!=e){e=e.substring(1);const t={};return e.split("&").forEach((e=>{const n=e.split("=");t[n[0]]=n[1]})),t}return null}function R(){return location.hash.substring(1)}function B(){}y=new WeakMap,w=new WeakMap,v=new WeakMap,E=new WeakMap,$=new WeakMap,x=new WeakMap,A=new WeakMap,N=new WeakMap,k=new WeakMap,b=new WeakSet,M=function G(e){if(e instanceof Element){const t=this.data,n=this.methods;!function(e,t){for(let n in t)n in e||Object.defineProperty(e,n,t[n])}(e,{data:{configurable:!1,enumerable:!0,get(){return t}},_:{configurable:!1,enumerable:!0,get(){return t}},methods:{configurable:!1,enumerable:!0,get(){return n}},$:{configurable:!1,enumerable:!0,get(){return n}}});const o=Array.from(e.attributes),r=Array.from(e.childNodes),i=[];for(let s=0;s<o.length;s++){let t=o[s].name,n=o[s].value;const r=!!t.match(C),l=!!t.match(L),a=!!n.match(C),c=!!n.match(L),f=r||l,d=a||c;let h,g,p,m;if(l&&console.warn(`It's not rational to declare a two-way binding attribute name: ${t}${H[2]} Use "${j.l}${t.substring(2,t.length-2)}${j.r}" instead.`),f&&d&&console.warn("Cannot set an attribute with both name and value dynamic. Dynamic will make only attribute name dynamic."),f){h=t.substring(2,t.length-2);const n=Symbol(),o={[n]:function(e,t){const n=this[h];if(t!==n){const o=e[1],r=o.getAttribute(t);o.removeAttribute(t),""!==n&&("string"==typeof n&&n!==n.toLowerCase()&&console.warn(`Attribute names are case insensitive, don't pass string with upper-case letters which may cause bugs: ${n}`),o.setAttribute(n,r))}}};h in S(this,A,"f")||(S(this,A,"f")[h]=undefined),u(S(this,A,"f"),S(this,x,"f")[h],o[n],e)}else if(d){g=n.substring(2,n.length-2),p=t[t.length-1]==_?t.substring(0,t.length-1):t;let o={};("value"==p||"checked"==p)&&e instanceof HTMLInputElement&&p in e?o.func=function(t,n){const o=this[g];n!==o&&(e[p]=o)}:(m=e instanceof HTMLInputElement?"defaultvalue"==p&&"defaultValue"in e?"value":"defaultchecked"==p&&"defaultChecked"in e?"checked":p:p,o.func=function(t,n){const o=this[g];n!==o&&(null===o?e.removeAttribute(m):e.setAttribute(m,o))}),g in S(this,A,"f")||(S(this,A,"f")[g]=undefined),u(S(this,A,"f"),S(this,x,"f")[g],o.func,e),c&&(e instanceof HTMLInputElement?"value"==t?e.addEventListener("input",(t=>{t.target===e&&(S(this,A,"f")[g]=e.value)})):"checked"==t&&e.addEventListener("input",(t=>{t.target===e&&(S(this,A,"f")[g]=e.checked)})):S(this,w,"f").set(e,(e=>{e.attributeName===m&&e.target.getAttribute(e.attributeName)!==S(this,A,"f")[g]&&(S(this,A,"f")[g]=e.target.getAttribute(e.attributeName))})))}f?i.push([1,t,h,n]):d&&i.push([2,t,m,g])}for(let s=0;s<i.length;s++){const t=i[s];1==t[0]?(e.removeAttribute(t[1]),e.setAttribute(S(this,A,"f")[t[2]],t[3])):2==t[0]&&(t[2]===undefined?e[t[1]]=S(this,A,"f")[t[3]]:(e.removeAttribute(t[1]),e.setAttribute(t[2],S(this,A,"f")[t[3]])))}for(let e=0;e<r.length;e++)S(this,b,"m",G).call(this,r[e])}else if(e instanceof Text&&e.textContent){const t=e.textContent,n=[...t.matchAll(P)],o=[...t.matchAll(W),...n],r=!!t.match(L),i=!!t.match(C);if(n.length>0&&!r&&console.warn(`Two-way bindings in "${t}" cannot be used in textContent template${H[2]}`),r){e.parentElement instanceof HTMLElement||console.warn("It's no use adding a two-way binding insert to an SVGElement, but dynamic will continue anyway.");const n=t.substring(2,t.length-2),o=e.parentNode;if(1==o.childNodes.length){const t=Symbol(),r={[t]:function(){const e=this[n];if(o.textContent!==e){if(e instanceof Element||e instanceof Array&&e[0]instanceof Element){if(o.innerHTML="",e instanceof Element)o.appendChild(e);else for(let t=0;t<e.length;t++)e[t]instanceof Element?o.appendChild(e[t]):o.appendChild(document.createTextNode(p(e[t])));return}o.textContent=e}}};n in S(this,A,"f")||(S(this,A,"f")[n]=undefined),u(S(this,A,"f"),S(this,x,"f")[n],r[t],e),o.addEventListener("input",(e=>{e.target===o&&o.textContent!==S(this,A,"f")[n]&&(S(this,A,"f")[n]=o.textContent)})),e.textContent=S(this,A,"f")[n]}else console.error("The parent element of a two-way binding text node must only have this text node.")}else if(o.length>0){const n=[],r=e.parentNode,l=e.nextSibling;for(let e=0;e<o.length;e++){const t=o[e][0].substring(2,o[e][0].length-2);n.push(t),t in S(this,A,"f")||(S(this,A,"f")[t]=undefined)}const a=s(n),c=Symbol(),f={[c]:function(e){const n=this[a[0]];if((n instanceof Element||n instanceof Array&&n[0]instanceof Element)&&i)if(e[2]=!0,r.innerHTML="",n instanceof Element)r.appendChild(n);else for(let t=0;t<n.length;t++)n[t]instanceof Element?r.appendChild(n[t]):r.appendChild(document.createTextNode(p(n[t])));else{let n=t;e[2]?(r.innerHTML="",e[1]=document.createTextNode(n),r.insertBefore(e[1],l)):document.contains(e[1])||(e[1]=document.createTextNode(n),r.insertBefore(e[1],l));let o=e[1];e[2]=!1;for(let e=0;e<a.length;e++){let t=this[a[e]];"object"==typeof t&&(t=p(t)),n=n.replaceAll(`${j.l}${a[e]}${j.r}`,t).replaceAll(`${T.l}${a[e]}${T.r}`,t)}o.textContent!==n&&(o.textContent=n)}}};for(let t=0;t<a.length;t++)u(S(this,A,"f"),S(this,x,"f")[a[t]],f[c],e)}}};const F=clearInterval;var V;function z(e){return new I(e)}(e=>{for(let t in e)z[t]=e[t]})({template:t,spa:n,manifest:o,e(e,t){return l(e,t)},render(e){return c(e.HTML,e.element,e.insertAfter,e.append)},toHTML(e){return a(e)},hatch(e,t){return function(e,t){const n=e.parentElement,o=Array.from(e.childNodes);for(let r=0;r<o.length;r++)n.insertBefore(o[r],e);return!0===t&&e.remove(),o}(e,t)},compose(){},__disableDevTools__:function(){V=setInterval((()=>{}),20),clearInterval=e=>{e!=V&&F.call(window,e)}},__enableDevTools__:function(){clearInterval=F,clearInterval(V)}}),function q(e){Object.freeze(e);for(let t=0;t<Object.keys(e).length;t++)"object"==typeof e[Object.keys(e)[t]]&&q(e[Object.keys(e)[t]])}(z);const Z=z;Object.defineProperty(window,"Dynamic",{configurable:!1,writable:!1,enumerable:!0,value:Z})})();
//# sourceMappingURL=dynamic.min.js.map